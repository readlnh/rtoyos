## GDT
|Base 31:32 | G |D/B|L|AVL|SegLimit19:16|P|DPL|S|Type|Base 23:16|
|-| -| -|-|-|-|-|-|-|-|-|

|Base Address15:00|Segment Limit 15:00|
|-|-|

- L -- 64-bit code segment(IA-32e mode only)
- AVL -- Avaliable for use by system software
- Base -- Segment base address
- D/B -- Default operation size (0 = 16-bit segment;1 = 32-bit segment)
- DPL -- Descriptor privilege level 描述符特权级
- G -- Granularity
- Limit -- Segment Limit
- P -- Segment present 段存在位
- S -- Descriptor type(0 = system; 1 = code or data) 描述符子类别
- Type -- Segment type 描述符类型

```
| 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 | 字节 
|76543210|7 6 5 4 3210 |7 65 4 3210|76543210|76543210|76543210|76543210|76543210| 比特 
|--------|-|-|-|-|---- |-|--|-|----|--------|--------|--------|--------|--------| 占位 
| BASE |G|D|0|A|LIMIT|P|D |S|TYPE|<------- BASE 23-0 ------>|<-- LIMIT 15-0 ->| 含义 
| 31-24 | |/| |V|19-16| |P | |B| |L| | |L |
```
- BASE: 段基址，由上图中的两部分(BASE 31-24 和 BSE23-0)组成
- G：LIMIT的单位，该位 0 表示单位是字节，1表示单位是 4KB
- D/B: 该位为 0 表示这是一个 16 位的段，1 表示这是一个 32 位段
- AVL: 该位是用户位，可以被用户自由使用
- LIMIT: 段的界限，单位由 G 位决定。数值上（经过单位换算后的值）等于段的长度（字节）- 1。
- P: 段存在位，该位为 0 表示该段不存在，为 1 表示存在。
- DPL：段权限
- S: 该位为 1 表示这是一个数据段或者代码段。为 0 表示这是一个系统段（比如调用门，中断门等）
- TYPE: 根据 S 位的结果，再次对段类型进行细分。

## GDTR
|47------------------16|15--------------0|
|:-------------:|-|
|全局描述符基地址|全局描述符边界| 

### access
|P|DPL|S|Type| 
|- |-----|-|------ |

- P位 称为存在(Present)位,
     * P=1表示描述符对地址转换是有效的，或者说该描述符所描述的段存在，即在内存中；
     * P=0表示描述符对地址转换无效，即该段不存在。使用该描述符进行内存访问时会引起异常。
     
- DPL表示描述符特权级(Descriptor Privilege level)
     * 共2位。它规定了所描述段的特权级，用于特权检查，以决定对该段能否访问。 
     
   - S位(DT位) Descriptor type说明描述符的类型
    * (0 = system; 1 = code or data) 该位为 1 表示这是一个数据段或者代码段。为 0 表示这是一个系统段（比如调用门，中断门等
   
  - TYPE 占4位
  
  |位3|位2|位1|位0|
  |:--:|----|----|----|
  | E|ED/C|W/R|A|
  
 * 其中的位0指示描述符是否被访问过(Accessed)，用符号A标记。
	* A=0表示尚未被访问，
	* A=1 表示段已被访问，
当把描述符的相应选择子装入到段寄存器时，80386把该位置为1，表明描述符已被访问，操作系统可测试访问位，已确定描述符是否被访问过。
此为位1，对应的type为奇数，因此type对应的数值为奇数时标识该描述符被访问过，否则为偶数标识未被访问过（可从前面的表中看出）

* 其中的位3指示所描述的段是代码段还是数据段，用符号E标记
	* E=0表示段为数据段，相应的描述符也就是数据段(包括堆栈段)描述符。数据段是不可执行的，但总是可读的。
	* E=1表示段是可执行段，即代码段，相应的描述符就是代码段描述符。代码段总是不可写的，若需要对代码段进行写入操作，则必须使用别名技术，即用一个可写的数据段描述符来描述该代码段，然后对此数据段进行写入。
此位为1时，type所对应的数值>=8(1000)，因此type<8标识为数据段，type>=8标识为代码段（可从前面的表中看出）

* 在数据段描述符中(E=0的情况)，TYPE中的位1指示所描述的数据段是否可写，用W标记
	* W=0表示对应的数据段不可写。
	* 反之，W=1表示数据段是可写的。

注意，数据段总是可读的。

* TYPE中的位2是ED位，指示所描述的数据段的扩展方向。
	* ED=0表示数据段向高端扩展，也即段内偏移必须小于等于段界限。
	* ED=1表示数据段向低扩展，段内偏移必须大于段界限。

* 在代码段描述符中(E=1的情况)，TYPE中的位1指示所描述的代码段是否可读，用符号R标记
	* R=0表示对应的代码段不可读，只能执行。
	* R=1表示对应的代码段可读可执行。

* 注意代码段总是不可写的，若需要对代码段进行写入操作，则必须使用别名技术。在代码段中，TYPE中的位2指示所描述的代码段是否是一致代码段，用C标记。
	* C=0表示对应的代码段不是一致代码段(普通代码段)
	* C=1表示对应的代码段是一致代码段。

> [原文](https://blog.csdn.net/gatieme/article/details/50647000 ) 

## granularity
|G|D/B|L|AVL|SegLimit19:16|
|-|-|-|-|-|

- G为就是段界限单位(Granularity)位
	* G=0表示界限单位为字节；
	* G=1表示界限单位为4K 字节。
	
注意，界限粒度只对段界限有效，对段基地址无效，段基地址总是以字节为单位。

- D/B位是一个很特殊的位在描述可执行段、向下扩展数据段或由SS寄存器寻址的段(通常是堆栈段)的三种描述符中的意义各不相同
在描述可执行段的描述符中，D位决定了指令使用的地址及操作数所默认的大小。
	* D=1表示默认情况下指令使用32位地址及32位或8位操作数，这样的代码段也称为32位代码段；
	* D=0 表示默认情况下，使用16位地址及16位或8位操作数，这样的代码段也称为16位代码段，它与80286兼容。可以使用地址大小前缀和操作数大小前缀分别改变默认的地址或操作数的大小。

在向下扩展数据段的描述符中，D位决定段的上部边界。
	* D=1表示段的上部界限为4G；
	* D=0表示段的上部界限为64K，这是为了与80286兼容。

在描述由SS寄存器寻址的段描述符中，D位决定隐式的堆栈访问指令(如PUSH和POP指令)使用何种堆栈指针寄存器。
	* D=1表示使用32位堆栈指针寄存器ESP；
	* D=0表示使用16位堆栈指针寄存器SP，这与80286兼容。

- AVL位是软件可利用位

故0xcf这个参数，表示limit的单位是4k，默认使用16位地址


## 段选择子
```
|   1   |     0    |  字节 
|7654321076543 2 10|  比特 
|-------------|-|--|  占位 
|    INDEX    |T|R |  含义 
|             |I|P | 
|             | |L |
--------------------- 
作者：--Allen-- 
来源：CSDN 
原文：https://blog.csdn.net/q1007729991/article/details/52538080 
版权声明：本文为博主原创文章，转载请附上博文链接！
```

|段描述符index|TI|RPL|
|-|-|-|
|15:3|2|1:0|

-    INDEX：在GDT数组或LDT数组的索引号
-   TI：Table Indicator,这个值为0表示查找GDT，1则查找LDT
-    RPL：请求特权级。以什么样的权限去访问段。

有一个特殊的选择子称为空(Null)选择子，它的Index=0，TI=0，而RPL字段可以为任意值。空选择子有特定的用途，当用空选择子进行存储访问时会引起异常。空选择子是特别定义的，它不对应于全局描述符表GDT中的第0个描述符，因此处理器中的第0个描述符总不被处理器访问，一般把它置成全0。但当TI=1时，Index为0的选择子不是空选择子，它指定了当前任务局部描述符表LDT中的第0个描述符。





